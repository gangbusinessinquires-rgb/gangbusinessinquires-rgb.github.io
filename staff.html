<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Portfolio | Mastering Logic</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="loader" style="height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; background:#000;">
        <h1 style="font-size:4rem; font-weight:900;">Loading...</h1>
        <p style="color:var(--accent-blue); font-family:'JetBrains Mono';">CONNECTING_TO_NODES</p>
    </div>

    <div id="content" style="display:none;">
        <nav>
            <div class="container" style="display:flex; justify-content:space-between;">
                <div class="logo">STAFF<span>PORTFOLIO</span></div>
                <a href="index.html" style="color:var(--accent-blue); text-decoration:none; font-weight:700;">Back Home</a>
            </div>
        </nav>

        <div class="container">
            <div id="staffHeader" style="text-align:center; margin-bottom:80px;">
                </div>

            <h2 style="margin-bottom:40px; font-size:2rem;">Project Contributions</h2>
            <div id="projectGrid" class="bot-display-grid">
                </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { projectId: "portfolio-a8de0", appId: "1:352813143804:web:9ab1d0f59f38d0b519e979" };
        const db = getFirestore(initializeApp(firebaseConfig));

        const urlParams = new URLSearchParams(window.location.search);
        const staffId = urlParams.get('id');

        async function init() {
            if(!staffId) { window.location.href = "index.html"; return; }

            const snap = await getDoc(doc(db, "staff", staffId));
            if(!snap.exists()) return;
            const s = snap.data();

            document.getElementById('staffHeader').innerHTML = `
                <img src="${s.img}" style="width:180px; height:180px; border-radius:50%; border:4px solid var(--accent-blue); margin-bottom:20px; object-fit:cover;">
                <h1 style="font-size:3rem;">${s.name}</h1>
                <p style="color:var(--accent-blue); font-weight:800; font-size:1.2rem; text-transform:uppercase;">${s.role}</p>
            `;

            onSnapshot(collection(db, "bots"), snap => {
                const grid = document.getElementById('projectGrid');
                grid.innerHTML = "";
                snap.forEach(d => {
                    const b = d.data();
                    // Relational check: Does this bot have this staff member as a contributor?
                    // Note: You can add an 'author' field to your bot architect to link them.
                    grid.innerHTML += `
                        <div class="bot-card">
                            <img src="${b.img}" class="bot-img">
                            <div class="bot-info">
                                <div class="bot-name">${b.name}</div>
                                <div class="bot-desc">${b.desc}</div>
                                <a href="${b.link}" class="primary-btn" style="display:block; text-decoration:none; text-align:center;">View Architecture</a>
                            </div>
                        </div>`;
                });
                
                // Final Reveal
                document.getElementById('loader').style.display = "none";
                document.getElementById('content').style.display = "block";
            });
        }
        init();
    </script>
</body>
</html>

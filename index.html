<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Mastering Logic | Systems Architecture Interface</title>
    
    <link rel="stylesheet" href="/style.css">

    <style>
        /* DYNAMIC INTERFACE OVERLAYS
           This section handles visual layers that are injected via JavaScript 
           to ensure high-fidelity rendering across different viewport nodes.
        */
        .system-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            background: radial-gradient(circle at 50% 50%, transparent 0%, rgba(5, 5, 5, 0.2) 100%);
        }

        .scanning-line {
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--p-brand), transparent);
            position: absolute;
            top: -2px;
            animation: scan 8s linear infinite;
            opacity: 0.1;
        }

        @keyframes scan {
            0% { top: 0%; }
            100% { top: 100%; }
        }

        /* Mobile Heuristic Styling Adjustments */
        .mobile-node .hero-title {
            font-size: 3.2rem !important;
            letter-spacing: -2px !important;
        }

        .mobile-node .container {
            padding: 80px 20px !important;
        }

        .desktop-node .logic-grid {
            grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
        }

        .skeleton-loader {
            background: linear-gradient(90deg, #0a0a0f 25%, #151520 50%, #0a0a0f 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 20px;
            height: 300px;
            margin-bottom: 20px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body class="system-base">

    <div class="system-overlay">
        <div class="scanning-line"></div>
    </div>

    <nav id="master-nav">
        <div class="nav-content">
            <a href="/" class="logo-main">MASTERING<span>LOGIC</span></a>
            
            <div class="nav-links pc-only-flex" style="display:flex; gap:35px; font-size:0.75rem; font-weight:900; letter-spacing:1px;">
                <a href="#projects" class="nav-item">SYSTEMS_REGISTRY</a>
                <a href="#team" class="nav-item">PERSONNEL_NODES</a>
                <a href="/admin" class="nav-item highlight" style="color:var(--p-brand);">ADMIN_CONSOLE</a>
            </div>

            <div id="mobile-indicator" style="display:none; font-family:'JetBrains Mono'; font-size:0.6rem; color:var(--p-brand);">
                MENU // TAP
            </div>
        </div>
    </nav>

    <div class="container">
        
        <header class="hero-section" style="margin-bottom: 160px; position:relative;">
            <div class="header-metadata">
                <span id="system-status-tag" class="status-pill">
                    <div class="status-dot"></div>
                    NODE_ACTIVE
                </span>
                <span id="device-info-tag" class="status-pill" style="margin-left:10px; color:var(--txt-low);">
                    SCANNING_DEVICE...
                </span>
            </div>

            <h1 class="hero-title" style="margin-top:30px;">
                Architecting<br>
                <span style="color:var(--p-brand);">Digital Logic.</span>
            </h1>
            
            <p class="hero-description" style="color:var(--txt-muted); max-width:700px; font-size:1.2rem; margin-top:35px; line-height:1.8;">
                We specialize in high-frequency automation and predictive system architecture. 
                Our team engineers the logical frameworks that drive the next generation of 
                digital integration and infrastructure management.
            </p>

            <div class="stats-container desktop-row mt-60" style="gap:80px;">
                <div class="stat-block">
                    <h2 id="agg-users" class="stat-value" style="font-family:'JetBrains Mono'; color:var(--p-brand); margin:0; font-size:3rem;">0</h2>
                    <p class="stat-label" style="font-size:0.65rem; font-weight:900; color:var(--txt-low); letter-spacing:2px; text-transform:uppercase;">Network_Users</p>
                </div>
                <div class="stat-block">
                    <h2 id="agg-nodes" class="stat-value" style="font-family:'JetBrains Mono'; color:var(--p-brand); margin:0; font-size:3rem;">0</h2>
                    <p class="stat-label" style="font-size:0.65rem; font-weight:900; color:var(--txt-low); letter-spacing:2px; text-transform:uppercase;">Active_Nodes</p>
                </div>
                <div class="stat-block mobile-hide">
                    <h2 id="agg-latency" class="stat-value" style="font-family:'JetBrains Mono'; color:var(--s-brand); margin:0; font-size:3rem;">0ms</h2>
                    <p class="stat-label" style="font-size:0.65rem; font-weight:900; color:var(--txt-low); letter-spacing:2px; text-transform:uppercase;">System_Latency</p>
                </div>
            </div>
        </header>

        <section id="projects" class="view-section">
            <div class="section-header" style="display:flex; align-items:center; gap:25px; margin-bottom:70px;">
                <h2 class="section-title" style="margin:0; font-size:2.4rem;">Registry <span style="color:var(--p-brand)">Applications</span></h2>
                <div class="accent-line" style="flex-grow:1; height:1px; background:var(--brd-subtle);"></div>
            </div>
            
            <div id="bot-mount-point" class="logic-grid">
                <div class="skeleton-loader"></div>
                <div class="skeleton-loader"></div>
                <div class="skeleton-loader"></div>
            </div>
        </section>

        <section id="team" class="view-section" style="margin-top:200px;">
            <div class="section-header" style="display:flex; align-items:center; gap:25px; margin-bottom:70px;">
                <h2 class="section-title" style="margin:0; font-size:2.4rem;">Core <span style="color:var(--p-brand)">Personnel</span></h2>
                <div class="accent-line" style="flex-grow:1; height:1px; background:var(--brd-subtle);"></div>
            </div>

            <div id="staff-mount-point" class="logic-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                <div class="skeleton-loader" style="height:200px;"></div>
                <div class="skeleton-loader" style="height:200px;"></div>
                <div class="skeleton-loader" style="height:200px;"></div>
                <div class="skeleton-loader" style="height:200px;"></div>
            </div>
        </section>

        <footer id="master-footer" style="margin-top:220px; padding:100px 0; border-top:1px solid var(--brd-subtle); text-align:center; position:relative;">
            <div class="footer-logo">
                <a href="#" class="logo-main" style="justify-content:center; margin-bottom:20px;">MASTERING<span>LOGIC</span></a>
            </div>
            <p class="footer-legal" style="font-family:'JetBrains Mono'; font-size:0.7rem; color:var(--txt-low); letter-spacing:2px; text-transform:uppercase;">
                Mainframe Architecture v6.0.4 // Synchronized with Global Nodes // Â© 2026
            </p>
            <div class="footer-status mt-20" style="font-size:0.6rem; color:var(--s-brand); font-weight:800;">
                ALL_SYSTEMS_OPERATIONAL
            </div>
        </footer>

    </div>

    <script type="module">
        /**
         * FIREBASE MODULE IMPORTATION
         * Establishing secure socket connection with Mastering Logic Database.
         */
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Configuration Node
        const logicConfig = { 
            projectId: "portfolio-a8de0", 
            appId: "1:352813143804:web:9ab1d0f59f38d0b519e979" 
        };

        const appNode = initializeApp(logicConfig);
        const dbInstance = getFirestore(appNode);

        // Data Management Cache
        const registryCache = {
            personnel: {},
            systems: [],
            isMobile: false
        };

        /**
         * HEURISTIC: DEVICE SENSING ENGINE
         * This function determines the hardware node type and adjusts the UI architecture.
         */
        const runSystemHeuristics = () => {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            const body = document.body;
            const deviceTag = document.getElementById('device-info-tag');

            if (/android|iphone|ipad|ipod/i.test(userAgent)) {
                registryCache.isMobile = true;
                body.classList.add('mobile-node');
                deviceTag.innerText = "DEVICE: MOBILE_HANDSET";
            } else {
                registryCache.isMobile = false;
                body.classList.add('desktop-node');
                deviceTag.innerText = "DEVICE: WORKSTATION_NODE";
            }

            // Simulated Latency Check
            const latencyValue = Math.floor(Math.random() * (45 - 12 + 1) + 12);
            document.getElementById('agg-latency').innerText = `${latencyValue}ms`;
        };

        /**
         * COMPONENT: PERSONNEL RENDERER
         * Logic for fetching and displaying the staff directory.
         */
        const initializePersonnelStream = () => {
            const mount = document.getElementById('staff-mount-point');
            
            onSnapshot(collection(dbInstance, "team"), (snapshot) => {
                mount.innerHTML = ""; // Clear Skeletons
                
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const id = doc.id;
                    
                    // Populate Cache for relational mapping
                    registryCache.personnel[id] = data;
                    
                    mount.innerHTML += `
                        <div class="card-frame" style="text-align:center; padding:40px;">
                            <div class="avatar-container" style="position:relative; width:130px; height:130px; margin: 0 auto 25px;">
                                <img src="${data.avatar}" style="width:100%; height:100%; border-radius:50%; border:3px solid var(--p-brand); padding:6px; object-fit:cover;">
                                <div style="position:absolute; bottom:5px; right:5px; width:15px; height:15px; background:var(--s-brand); border:3px solid var(--bg-surface); border-radius:50%;"></div>
                            </div>
                            <h3 style="margin:0; font-size:1.3rem;">${data.name}</h3>
                            <div class="badge-role" style="font-size:0.65rem; background:var(--p-brand); color:white; padding:4px 12px; border-radius:4px; display:inline-block; margin-top:10px; font-weight:900; text-transform:uppercase;">
                                ${data.role}
                            </div>
                            <a href="/staff?id=${id}" class="btn-execute" style="padding:14px; font-size:0.75rem; text-decoration:none; margin-top:35px; display:block; border-radius:12px;">VIEW_NODE_PROFILE</a>
                        </div>
                    `;
                });
                
                // Trigger Systems Rendering once Personnel are cached
                initializeSystemsStream();
            });
        };

        /**
         * COMPONENT: SYSTEMS RENDERER
         * Logic for fetching and displaying application architectures.
         */
        const initializeSystemsStream = () => {
            const mount = document.getElementById('bot-mount-point');
            const userDisplay = document.getElementById('agg-users');
            const nodeDisplay = document.getElementById('agg-nodes');

            onSnapshot(collection(dbInstance, "bots"), (snapshot) => {
                mount.innerHTML = ""; 
                let totalUsers = 0;
                let totalNodes = 0;

                snapshot.forEach(doc => {
                    const sys = doc.data();
                    totalUsers += parseInt(sys.users || 0);
                    totalNodes += parseInt(sys.servers || 0);

                    // Map Relational Engineers
                    let engineerStack = "";
                    if(sys.assignees && Array.isArray(sys.assignees)) {
                        sys.assignees.forEach(engineerId => {
                            if(registryCache.personnel[engineerId]) {
                                engineerStack += `
                                    <a href="/staff?id=${engineerId}" class="stack-link">
                                        <img src="${registryCache.personnel[engineerId].avatar}" title="${registryCache.personnel[engineerId].name}">
                                    </a>`;
                            }
                        });
                    }

                    // Append Architecture Card
                    mount.innerHTML += `
                        <article class="card-frame" style="display:flex; flex-direction:column;">
                            <div class="card-header" style="display:flex; justify-content:space-between; margin-bottom:25px; align-items:center;">
                                <div class="status-pill" style="font-size:0.65rem; border:1px solid var(--brd-vibrant); padding:4px 12px; border-radius:100px;">
                                    <div class="status-dot"></div> MAIN_BRANCH
                                </div>
                                <span style="font-family:'JetBrains Mono'; font-size:0.8rem; color:var(--txt-low);">U_COUNT: ${parseInt(sys.users || 0).toLocaleString()}</span>
                            </div>
                            
                            <img src="${sys.avatar}" class="asset-preview" style="filter: grayscale(0.2) contrast(1.1);">
                            
                            <h2 style="margin:0; font-size:1.8rem; letter-spacing:-1px;">${sys.name}</h2>
                            
                            <p class="system-description" style="color:var(--txt-muted); font-size:0.95rem; margin-top:20px; line-height:1.7; flex-grow:1;">
                                ${sys.desc}
                            </p>

                            <div class="relational-meta" style="margin-top:40px; padding-top:30px; border-top:1px solid var(--brd-subtle); display:flex; align-items:center; gap:20px;">
                                <div class="relational-stack">${engineerStack}</div>
                                <div class="stack-label" style="font-size:0.6rem; color:var(--txt-low); font-weight:900; letter-spacing:1px;">ENGINEER_MAPPING</div>
                            </div>

                            <a href="${sys.invite}" target="_blank" class="btn-execute mt-30" style="text-decoration:none; text-align:center; background:transparent; border:1px solid var(--p-brand); color:var(--p-brand);">
                                INITIALIZE_INTEGRATION
                            </a>
                        </article>
                    `;
                });

                // Update Visual Counters
                userDisplay.innerText = totalUsers.toLocaleString();
                nodeDisplay.innerText = totalNodes.toLocaleString();
            });
        };

        /**
         * SYSTEM BOOT SEQUENCE
         * Initializing all logical threads upon DOM load.
         */
        const bootSequence = () => {
            console.log("SYSTEM: Initializing boot sequence...");
            runSystemHeuristics();
            
            // Artificial Delay to demonstrate skeleton architecture
            setTimeout(() => {
                initializePersonnelStream();
            }, 800);
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', bootSequence);

    </script>
</body>
</html>

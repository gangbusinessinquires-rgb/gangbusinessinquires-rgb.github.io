<!DOCTYPE html>
<html>
<head>
    <title>Admin Portal</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="admin-section">
            <h3>ğŸ‘¥ Team Editor</h3>
            <input type="hidden" id="edit-id">
            <input type="text" id="tName" placeholder="Full Name" class="admin-input">
            <input type="text" id="tRole" placeholder="Role" class="admin-input">
            <input type="text" id="tAvatar" placeholder="Avatar URL" class="admin-input">
            <button onclick="saveMember()" class="play-btn">Save Member</button>
        </div>

        <div class="admin-section">
            <h3>ğŸ› ï¸ Manage Entries</h3>
            <div id="manage-list"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, updateDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBxZOiNLQixhfEK5_U-yf1wDi7f1oyM9NQ",
            authDomain: "portfolio-a8de0.firebaseapp.com",
            projectId: "portfolio-a8de0",
            storageBucket: "portfolio-a8de0.firebasestorage.app",
            messagingSenderId: "352813143804",
            appId: "1:352813143804:web:9ab1d0f59f38d0b519e979"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.saveMember = async () => {
            const id = document.getElementById('edit-id').value;
            const data = {
                name: document.getElementById('tName').value,
                role: document.getElementById('tRole').value,
                avatar: document.getElementById('tAvatar').value,
                hasPortfolio: true
            };
            id ? await updateDoc(doc(db, "team", id), data) : await addDoc(collection(db, "team"), data);
            location.reload();
        };

        onSnapshot(collection(db, "team"), (s) => {
            const list = document.getElementById('manage-list');
            list.innerHTML = "";
            s.forEach(d => {
                const t = d.data();
                list.innerHTML += `
                    <div class="manage-item">
                        <span>${t.name}</span>
                        <div>
                            <button class="edit-btn" onclick="editItem('${d.id}')">Edit</button>
                            <button class="del-btn" onclick="deleteItem('${d.id}')">Del</button>
                        </div>
                    </div>`;
            });
        });

        window.editItem = async (id) => {
            const d = await getDoc(doc(db, "team", id));
            const t = d.data();
            document.getElementById('edit-id').value = id;
            document.getElementById('tName').value = t.name;
            document.getElementById('tRole').value = t.role;
            document.getElementById('tAvatar').value = t.avatar;
        };

        window.deleteItem = async (id) => { if(confirm("Delete?")) await deleteDoc(doc(db, "team", id)); };
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev Portfolio | JS & Python</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>
    <nav>
        <div class="logo">DEV<span>PORTFOLIO</span></div>
        <a href="admin.html" class="login-btn">Admin Portal</a>
    </nav>

    <div class="hero">
        <div class="badge">âœ¨ Professional Development</div>
        <h1>Mastering <span>Logic</span></h1>
        <div class="tech-stack">
            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/javascript/javascript-original.svg" alt="JS">
            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/python/python-original.svg" alt="Python">
        </div>
        <div class="stats-container">
            <div class="stat-box"><div class="stat-val" id="total-users">0</div><div class="stat-label">Users</div></div>
            <div class="stat-box"><div class="stat-val" id="total-servers">0</div><div class="stat-label">Servers</div></div>
        </div>
    </div>

    <div class="container">
        <h2 class="section-title">Projects</h2>
        <div id="bot-display" class="grid"></div>
        
        <h2 class="section-title" style="margin-top: 80px;">The Team</h2>
        <div id="team-display" class="grid-team"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBxZOiNLQixhfEK5_U-yf1wDi7f1oyM9NQ",
            authDomain: "portfolio-a8de0.firebaseapp.com",
            projectId: "portfolio-a8de0",
            storageBucket: "portfolio-a8de0.firebasestorage.app",
            messagingSenderId: "352813143804",
            appId: "1:352813143804:web:9ab1d0f59f38d0b519e979"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        let teamData = {};

        onSnapshot(collection(db, "team"), (s) => {
            const display = document.getElementById('team-display');
            display.innerHTML = "";
            teamData = {};
            s.forEach(d => {
                const t = d.data();
                teamData[d.id] = t;
                display.innerHTML += `
                    <div class="team-card">
                        <img src="${t.avatar || 'https://via.placeholder.com/60'}" class="team-avatar">
                        <div class="team-info">
                            <h4>${t.name}</h4>
                            <span class="role-badge">${t.role}</span>
                            <div class="contributions" id="contributions-${d.id}"></div>
                            <button onclick="alert('Coming Soon!')" class="member-port-btn">View Portfolio</button>
                        </div>
                    </div>`;
            });
            loadBots();
        });

        function loadBots() {
            onSnapshot(collection(db, "bots"), (s) => {
                const display = document.getElementById('bot-display');
                let u = 0, ser = 0;
                display.innerHTML = "";
                document.querySelectorAll('.contributions').forEach(el => el.innerHTML = "");

                s.forEach((d) => {
                    const b = d.data();
                    u += parseInt(b.users || 0); ser += parseInt(b.servers || 0);
                    const statusColor = b.status === "Online" ? "#43b581" : "#faa61a";
                    const langImg = b.language === "JavaScript" ? 
                        "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/javascript/javascript-original.svg" : 
                        "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/python/python-original.svg";

                    let avatars = "";
                    if (b.contributors) {
                        b.contributors.forEach(mid => {
                            if (teamData[mid]) {
                                avatars += `<img src="${teamData[mid].avatar}" class="mini-avatar" title="${teamData[mid].name}">`;
                                const contEl = document.getElementById(`contributions-${mid}`);
                                if (contEl) contEl.innerHTML += `<span class="proj-tag">${b.name}</span>`;
                            }
                        });
                    }

                    display.innerHTML += `
                        <div class="bot-card">
                            <div class="status-indicator" style="background:${statusColor}"></div>
                            <div class="lang-tag"><img src="${langImg}" width="14"> ${b.language || 'JS'}</div>
                            <div class="bot-header">
                                <img src="${b.avatar || 'https://via.placeholder.com/50'}" class="bot-pfp">
                                <div>
                                    <div class="bot-tag">@${b.username}</div>
                                    <h3>${b.name}</h3>
                                </div>
                            </div>
                            <p>${b.desc}</p>
                            <div class="contributor-list">${avatars}</div>
                            <div class="bot-stats-row"><span>ðŸ“Š ${b.servers} Servers</span><span>ðŸ‘¥ ${b.users} Users</span></div>
                            <a href="${b.invite}" target="_blank" class="play-btn">Invite Now</a>
                        </div>`;
                });
                document.getElementById('total-users').innerText = u.toLocaleString();
                document.getElementById('total-servers').innerText = ser.toLocaleString();
            });
        }
    </script>
</body>
</html>
